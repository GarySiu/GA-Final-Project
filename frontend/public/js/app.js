function setMagnetListHeight(){$magnetList.css("height",$(window).height()-300)}function buildAreaInit(){$buildArea.sortable({receive:function(t,e){updateTweetText(),e.item.draggable("destroy"),e.item.css("transform","rotate(0deg)")},placeholder:"ui-state-highlight",over:function(){removeIntent=!1},out:function(){removeIntent=!0},beforeStop:function(t,e){if(1==removeIntent){updateTweetText();var a=e.item.detach();reInitMagnet(a,e)}}})}function reInitMagnet(t,e){$magnetList.append(t),t.draggable({cursor:"-webkit-grabbing",stack:"#magnet-list li",connectToSortable:"#build-area",scroll:!1}),t.css("left",event.pageX-e.item.width()/2),t.css("top",event.pageY-156+e.item.height()/2);var a=Math.floor(10*Math.random())-4+"deg";t.css("transform","rotate("+a+")")}function updateTweetText(){var t=$buildArea.sortable("toArray",{attribute:"data-text"}).join(" ");updateCharCount(t.length),t=encodeURIComponent(t),$tweetButton.attr("href","https://twitter.com/intent/tweet?text="+t)}function updateCharCount(t){$charCount.html(140-t)}function setListeners(){$searchButton.on("click",function(){event.preventDefault(),getMagnets()}),$(window).on("resize",setMagnetListHeight)}function getMagnets(){$.get("http://localhost:3000/search?type=twitter&q="+encodeURIComponent($searchBox.val())).done(function(t){appendMagnets(t),makeMagnetsDraggable(),scatterMagnets()})}function appendMagnets(t){$.each(t,function(t,e){var a='<li data-text="'+e+'">'+e+"</li>";$magnetList.append(a).hide().fadeIn("slow")})}function makeMagnetsDraggable(){$("li").draggable({cursor:"-webkit-grabbing",stack:"#magnet-list li",connectToSortable:"#build-area",scroll:!1})}function scatterMagnets(){$.each($("li"),function(t,e){var a=Math.abs(Math.floor(Math.random()*$(window).width()-$(window).width()/2)),n=Math.abs(Math.floor(Math.random()*$magnetList.height()-50)),o=Math.floor(10*Math.random())-4+"deg";$(e).css("left",a),$(e).css("top",n),$(e).css("transform","rotate("+o+")")})}$(document).ready(function(){$magnetList=$("#magnet-list"),$searchBox=$("#search-box"),$searchButton=$("#search-button"),$buildArea=$("#build-area"),$tweetButton=$("#tweet-button"),$charCount=$("#char-count"),setListeners(),setMagnetListHeight(),getMagnets(),buildAreaInit()}).ajaxStart(function(){$magnetList.empty(),$buildArea.empty(),$charCount.html(140),$magnetList.append('<div class="progress"><div class="indeterminate"></div></div>')}).ajaxStop(function(){$("#magnet-list > .progress").remove()});