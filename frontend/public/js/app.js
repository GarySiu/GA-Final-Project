function setMagnetListHeight(){$magnetList.css("height",$(window).height()-310)}function buildAreaInit(){$buildArea.sortable({receive:function(t,e){updateTweetText(),e.item.draggable("destroy"),e.item.css("transform","rotate(0deg)")},placeholder:"ui-state-highlight",over:function(){removeIntent=!1},out:function(){removeIntent=!0},beforeStop:function(t,e){if(removeIntent===!0){updateTweetText();var n=e.item.detach();reInitMagnet(n,e)}}})}function reInitMagnet(t,e){var n=Math.floor(10*Math.random())-4+"deg";$magnetList.append(t),t.draggable({cursor:"-webkit-grabbing",stack:"#magnet-list li",connectToSortable:"#build-area",scroll:!1}).css("left",event.pageX-2*e.item.width()).css("top",event.pageY-60-2*e.item.height()).css("transform","rotate("+n+")")}function updateTweetText(){var t=$buildArea.sortable("toArray",{attribute:"data-text"}).join(" ");updateCharCount(t.length),t=encodeURIComponent(t),$tweetButton.attr("href","https://twitter.com/intent/tweet?text="+t)}function updateCharCount(t){$charCount.html(140-t)}function setListeners(){$searchButton.on("click",function(){event.preventDefault(),getMagnets()}),$arrangeButton.on("click",function(){event.preventDefault(),arrangeMagnets()}),$scatterButton.on("click",function(){event.preventDefault(),scatterMagnets()}),$(window).on("resize",setMagnetListHeight)}function getMagnets(){$.get(endpoint+"search?type=twitter&q="+encodeURIComponent($searchBox.val())).done(function(t){appendMagnets(t),makeMagnetsDraggable(),scatterMagnets()})}function appendMagnets(t){$.each(t,function(t,e){var n='<li data-text="'+e+'">'+e+"</li>";$magnetList.append(n).hide().fadeIn("slow")})}function makeMagnetsDraggable(){$("#magnet-list li").draggable({cursor:"-webkit-grabbing",stack:"#magnet-list li",connectToSortable:"#build-area",scroll:!1})}function arrangeMagnets(){$("#magnet-list li").draggable("destroy").css("left",0).css("top",0).css("position","static"),makeMagnetsDraggable()}function scatterMagnets(){$.each($("#magnet-list li"),function(t,e){var n=Math.abs(Math.floor(Math.random()*$(window).width()-$(window).width()/2.25)),a=Math.abs(Math.floor(Math.random()*$magnetList.height()-50)),o=Math.floor(8*Math.random())-3+"deg";$(e).css("position","absolute").css("left",n).css("top",a).css("transform","rotate("+o+")")})}var endpoint="http://localhost:3000/";$(document).ready(function(){$magnetList=$("#magnet-list"),$searchBox=$("#search-box"),$searchButton=$("#search-button"),$buildArea=$("#build-area"),$tweetButton=$("#tweet-button"),$charCount=$("#char-count"),$arrangeButton=$("#arrange-button"),$scatterButton=$("#scatter-button"),setListeners(),setMagnetListHeight(),getMagnets(),buildAreaInit()}).ajaxStart(function(){$magnetList.empty(),$buildArea.empty(),$charCount.html(140),$magnetList.append('<div class="progress"><div class="indeterminate"></div></div>')}).ajaxStop(function(){$("#magnet-list .progress").remove()}).ajaxError(function(){$("#magnet-list .progress").remove(),appendMagnets(["An error occured"])});